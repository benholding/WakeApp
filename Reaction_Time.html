<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />


<meta name="author" content="Benjamin Holding" />


<title>Reaction Time</title>

<script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/bootstrap.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<link href="site_libs/highlightjs-1.1/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-1.1/highlight.js"></script>

<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>
<script type="text/javascript">
if (window.hljs && document.readyState && document.readyState === "complete") {
   window.setTimeout(function() {
      hljs.initHighlighting();
   }, 0);
}
</script>



<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.table th:not([align]) {
  text-align: left;
}
</style>


</head>

<body>

<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
  height: auto;
}
.tabbed-pane {
  padding-top: 12px;
}
button.code-folding-btn:focus {
  outline: none;
}
</style>


<style type="text/css">
/* padding for bootstrap navbar */
body {
  padding-top: 51px;
  padding-bottom: 40px;
}
/* offset scroll position for anchor links (for fixed navbar)  */
.section h1 {
  padding-top: 56px;
  margin-top: -56px;
}

.section h2 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h3 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h4 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h5 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h6 {
  padding-top: 56px;
  margin-top: -56px;
}
</style>

<script>
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.parent().addClass('active');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');
});
</script>


<div class="container-fluid main-container">

<!-- tabsets -->
<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});
</script>

<!-- code folding -->




<script>
$(document).ready(function ()  {

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_').toLowerCase();
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}


.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
  padding-left: 25px;
  text-indent: 0;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>

<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row-fluid">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">WakeApp: SleSI</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">Home</a>
</li>
<li>
  <a href="Reaction_Time.html">Reaction time</a>
</li>
<li>
  <a href="WorkingMemory.html">Working memory</a>
</li>
<li>
  <a href="Short-term_memory.html">Short-term memory</a>
</li>
<li>
  <a href="Maths.html">Maths (Score/RT)</a>
</li>
<li>
  <a href="Stroop.html">Stroop (Score/RT)</a>
</li>
<li>
  <a href="about.html">About</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div class="fluid-row" id="header">



<h1 class="title toc-ignore">Reaction Time</h1>
<h4 class="author"><em>Benjamin Holding</em></h4>
<h4 class="date"><em>Last Updated: September 22, 2017</em></h4>

</div>


<div id="removing-problem-answers" class="section level1">
<h1>removing problem answers</h1>
<p>(only between 100-4000milliseconds)</p>
<pre class="r"><code>KSS_Complete_TIDY &lt;- KSS_Complete_TIDY[which(KSS_Complete_TIDY$reaction_time &gt; 100 &amp; KSS_Complete_TIDY$reaction_time &lt; 4000),]</code></pre>
</div>
<div id="assessing-the-best-growth-curve-model" class="section level1">
<h1>Assessing the best growth curve model</h1>
<div id="should-i-add-a-random-intercept---yes" class="section level3">
<h3>Should I add a random intercept? - yes</h3>
<pre class="r"><code>model.1&lt;-gls(reaction_time~1, data=KSS_Complete_TIDY, na.action=na.omit)
summary(model.1)</code></pre>
<pre><code>## Generalized least squares fit by REML
##   Model: reaction_time ~ 1 
##   Data: KSS_Complete_TIDY 
##        AIC      BIC    logLik
##   254736.9 254752.6 -127366.5
## 
## Coefficients:
##                Value Std.Error  t-value p-value
## (Intercept) 507.0326  1.441072 351.8441       0
## 
## Standardized residuals:
##        Min         Q1        Med         Q3        Max 
## -2.0450515 -0.5239775 -0.2066674  0.2164128 16.9834834 
## 
## Residual standard error: 198.5439 
## Degrees of freedom: 18982 total; 18981 residual</code></pre>
<pre class="r"><code>model.2&lt;-lme(reaction_time~1, random=~1|ID, data=KSS_Complete_TIDY, na.action=na.omit)
anova(model.1,model.2) #model with random effects is significantly better</code></pre>
<pre><code>##         Model df      AIC      BIC    logLik   Test  L.Ratio p-value
## model.1     1  2 254736.9 254752.6 -127366.5                        
## model.2     2  3 250972.2 250995.8 -125483.1 1 vs 2 3766.687  &lt;.0001</code></pre>
<pre class="r"><code>summary(model.2)</code></pre>
<pre><code>## Linear mixed-effects model fit by REML
##  Data: KSS_Complete_TIDY 
##        AIC      BIC    logLik
##   250972.2 250995.8 -125483.1
## 
## Random effects:
##  Formula: ~1 | ID
##         (Intercept) Residual
## StdDev:    100.6119  176.862
## 
## Fixed effects: reaction_time ~ 1 
##                Value Std.Error    DF  t-value p-value
## (Intercept) 513.3558  7.680223 18805 66.84126       0
## 
## Standardized Within-Group Residuals:
##        Min         Q1        Med         Q3        Max 
## -4.4459521 -0.4024097 -0.1709972  0.1193008 19.0578603 
## 
## Number of Observations: 18982
## Number of Groups: 177</code></pre>
<pre class="r"><code>VarCorr(model.2)</code></pre>
<pre><code>## ID = pdLogChol(1) 
##             Variance StdDev  
## (Intercept) 10122.76 100.6119
## Residual    31280.16 176.8620</code></pre>
<pre class="r"><code>10122.76/(10122.76+31280.16) #25% of variance can be attributed to variance in RT between individuals</code></pre>
<pre><code>## [1] 0.2444939</code></pre>
</div>
<div id="should-i-have-a-time-polynomial-effect---yes-cubic" class="section level3">
<h3>Should I have a time polynomial effect? - yes (cubic)</h3>
<pre class="r"><code># assessing the best time polynomial
model.3a&lt;-lme(reaction_time~1, random=~1|ID, data=KSS_Complete_TIDY, na.action=na.omit, method=&quot;ML&quot;)
# model.3b&lt;-lme(reaction_time~time, random=~1|ID, data=KSS_Complete_TIDY, na.action=na.omit, method=&quot;ML&quot;) # DOESN&#39;T CONVERGE
model.3c&lt;-lme(reaction_time~time+I(time^2), random=~1|ID, data=KSS_Complete_TIDY, na.action=na.omit, method=&quot;ML&quot;)
model.3d&lt;-lme(reaction_time~time+I(time^2)+I(time^3), random=~1|ID, data=KSS_Complete_TIDY, na.action=na.omit, method=&quot;ML&quot;) 

anova(model.3a, model.3c, model.3d) #the cubic model is the best</code></pre>
<pre><code>##          Model df      AIC      BIC    logLik   Test   L.Ratio p-value
## model.3a     1  3 250978.2 251001.7 -125486.1                         
## model.3c     2  5 250859.0 250898.2 -125424.5 1 vs 2 123.20989  &lt;.0001
## model.3d     3  6 250795.7 250842.8 -125391.9 2 vs 3  65.22911  &lt;.0001</code></pre>
<pre class="r"><code>summary(model.3d)</code></pre>
<pre><code>## Linear mixed-effects model fit by maximum likelihood
##  Data: KSS_Complete_TIDY 
##        AIC      BIC    logLik
##   250795.7 250842.8 -125391.9
## 
## Random effects:
##  Formula: ~1 | ID
##         (Intercept) Residual
## StdDev:    100.2471 175.9795
## 
## Fixed effects: reaction_time ~ time + I(time^2) + I(time^3) 
##                Value Std.Error    DF  t-value p-value
## (Intercept) 486.5475  7.985157 18802 60.93148       0
## time         93.7855  9.905519 18802  9.46801       0
## I(time^2)   -72.5765  8.743039 18802 -8.30107       0
## I(time^3)    15.5206  1.920221 18802  8.08269       0
##  Correlation: 
##           (Intr) time   I(t^2)
## time      -0.157              
## I(time^2)  0.096 -0.960       
## I(time^3) -0.073  0.913 -0.989
## 
## Standardized Within-Group Residuals:
##        Min         Q1        Med         Q3        Max 
## -4.5280682 -0.4028480 -0.1685624  0.1156413 19.0294575 
## 
## Number of Observations: 18982
## Number of Groups: 177</code></pre>
</div>
<div id="should-i-add-random-slopes---yes-random-slopes-up-to-quadratic-effect" class="section level3">
<h3>Should I add random slopes? - Yes (random slopes up to quadratic effect)</h3>
<pre class="r"><code># assessing the best random effects term
model.4a&lt;-lme(reaction_time~time+I(time^2)+I(time^3), random=~1|ID, data=KSS_Complete_TIDY, na.action=na.omit, method=&quot;REML&quot;) 

model.4b&lt;-lme(reaction_time~time+I(time^2)+I(time^3), random=~time|ID, data=KSS_Complete_TIDY, na.action=na.omit, method=&quot;REML&quot;) 

model.4c&lt;-lme(reaction_time~time+I(time^2)+I(time^3), random=~time+I(time^2)|ID, data=KSS_Complete_TIDY, na.action=na.omit, method=&quot;REML&quot;) 

# model.4d&lt;-lme(reaction_time~time+I(time^2)+I(time^3), random=~time+I(time^2)+I(time^3)|ID, data=KSS_Complete_TIDY, na.action=na.omit, method=&quot;REML&quot;) #doesn&#39;t converge

anova(model.4a,model.4b,model.4c) #having random slopes for quadratic term for time is best</code></pre>
<pre><code>##          Model df      AIC      BIC    logLik   Test  L.Ratio p-value
## model.4a     1  6 250782.2 250829.3 -125385.1                        
## model.4b     2  8 250479.2 250542.0 -125231.6 1 vs 2 306.9639  &lt;.0001
## model.4c     3 11 250215.8 250302.2 -125096.9 2 vs 3 269.3950  &lt;.0001</code></pre>
</div>
<div id="adding-the-sleep-condition-as-a-predictor" class="section level3">
<h3>adding the sleep condition as a predictor</h3>
<pre class="r"><code>#additing in variables can that explain intercept and slope variability
model.6a&lt;-lme(reaction_time~time+I(time^2)+I(time^3), random=~time+I(time^2)|ID, data=KSS_Complete_TIDY, na.action=na.omit, method=&quot;ML&quot;) 
model.6b&lt;-lme(reaction_time~time+I(time^2)+I(time^3)+SD, random=~time+I(time^2)|ID, data=KSS_Complete_TIDY, na.action=na.omit, method=&quot;ML&quot;) 

anova(model.6a,model.6b)#condition doesn&#39;t predict intercept, which is good because there should be no difference</code></pre>
<pre><code>##          Model df      AIC      BIC    logLik   Test    L.Ratio p-value
## model.6a     1 11 250232.2 250318.6 -125105.1                          
## model.6b     2 12 250234.2 250328.4 -125105.1 1 vs 2 0.02125224  0.8841</code></pre>
<pre class="r"><code>model.6c &lt;-lme(reaction_time~time*SD+I(time^2)+I(time^3), random=~time+I(time^2)|ID, data=KSS_Complete_TIDY, na.action=na.omit, method=&quot;ML&quot;) 

anova(model.6a,model.6c) #sleep deprivation explains variance in slope of time (linear)</code></pre>
<pre><code>##          Model df      AIC      BIC    logLik   Test  L.Ratio p-value
## model.6a     1 11 250232.2 250318.6 -125105.1                        
## model.6c     2 13 250202.8 250304.9 -125088.4 1 vs 2 33.39501  &lt;.0001</code></pre>
<pre class="r"><code>model.6d &lt;-lme(reaction_time~time*SD+I(time^2)*SD+I(time^3), random=~time+I(time^2)|ID, data=KSS_Complete_TIDY, na.action=na.omit, method=&quot;ML&quot;) #sleep deprivation explains variance in the slope of time (quadratic)
anova(model.6a,model.6d)</code></pre>
<pre><code>##          Model df      AIC      BIC    logLik   Test  L.Ratio p-value
## model.6a     1 11 250232.2 250318.6 -125105.1                        
## model.6d     2 14 250196.0 250305.9 -125084.0 1 vs 2 42.25551  &lt;.0001</code></pre>
<pre class="r"><code>model.6e &lt;-lme(reaction_time~time*SD+I(time^2)*SD+I(time^3)*SD, random=~time+I(time^2)|ID, data=KSS_Complete_TIDY, na.action=na.omit, method=&quot;ML&quot;) #sleep deprivation explains variance in the slope of time (quadratic)
anova(model.6a,model.6e) #sleep deprivation explains variance in the slope of time (cubic)</code></pre>
<pre><code>##          Model df      AIC      BIC    logLik   Test L.Ratio p-value
## model.6a     1 11 250232.2 250318.6 -125105.1                       
## model.6e     2 15 250173.8 250291.5 -125071.9 1 vs 2 66.4471  &lt;.0001</code></pre>
</div>
</div>
<div id="the-best-fitting-growth-curve-model" class="section level1">
<h1>The best fitting growth curve model</h1>
<p>There is an interaction between the condition and linear effect of time, the quadratic effect of time and the cubic effect of time. The p value for tells you whether the difference in the curvature for the two condition is statistically significant.</p>
<pre class="r"><code>summary(model.6e)</code></pre>
<pre><code>## Linear mixed-effects model fit by maximum likelihood
##  Data: KSS_Complete_TIDY 
##        AIC      BIC    logLik
##   250173.8 250291.5 -125071.9
## 
## Random effects:
##  Formula: ~time + I(time^2) | ID
##  Structure: General positive-definite, Log-Cholesky parametrization
##             StdDev    Corr         
## (Intercept)  91.22106 (Intr) time  
## time         82.73915 -0.047       
## I(time^2)    27.96994  0.013 -0.947
## Residual    170.94478              
## 
## Fixed effects: reaction_time ~ time * SD + I(time^2) * SD + I(time^3) * SD 
##                 Value Std.Error    DF  t-value p-value
## (Intercept)  503.5467 10.716187 18798 46.98936  0.0000
## time           9.6891 16.946393 18798  0.57175  0.5675
## SD           -32.3790 14.670430 18798 -2.20709  0.0273
## I(time^2)    -21.0836 12.781896 18798 -1.64949  0.0991
## I(time^3)      5.9908  2.707998 18798  2.21228  0.0270
## time:SD      160.9790 23.443607 18798  6.86665  0.0000
## SD:I(time^2) -99.2619 17.825225 18798 -5.56862  0.0000
## SD:I(time^3)  18.6685  3.794606 18798  4.91974  0.0000
##  Correlation: 
##              (Intr) time   SD     I(t^2) I(t^3) tim:SD SD:I(^2
## time         -0.195                                           
## SD           -0.723  0.143                                    
## I(time^2)     0.122 -0.908 -0.089                             
## I(time^3)    -0.092  0.768  0.068 -0.960                      
## time:SD       0.141 -0.723 -0.182  0.656 -0.555               
## SD:I(time^2) -0.085  0.651  0.110 -0.717  0.689 -0.907        
## SD:I(time^3)  0.063 -0.549 -0.081  0.685 -0.714  0.767 -0.960 
## 
## Standardized Within-Group Residuals:
##        Min         Q1        Med         Q3        Max 
## -5.1834932 -0.3798376 -0.1541995  0.1219331 19.0476255 
## 
## Number of Observations: 18982
## Number of Groups: 177</code></pre>
</div>
<div id="plotting-the-final-model" class="section level1">
<h1>plotting the final model</h1>
<pre class="r"><code>KSS_Complete_TIDY$SD &lt;- as.factor(KSS_Complete_TIDY$SD)
RT.final.model &lt;-lme(reaction_time~time*SD+I(time^2)*SD+I(time^3)*SD, random=~time+I(time^2)|ID, data=KSS_Complete_TIDY, na.action=na.omit, method=&quot;ML&quot;)

#raw data plot with 95% confidence intervals
ggplot(KSS_Complete_TIDY, aes(time, reaction_time, colour=SD)) + 
  stat_summary(fun.data=mean_cl_normal, fun.args=list(conf.int=0.95), geom=&quot;pointrange&quot;) + 
  labs(y=&quot;Reaction Time (ms)&quot;, x=&quot;Time point&quot;) + 
  theme_bw() + scale_color_manual(values=c(&quot;red&quot;, &quot;blue&quot;)) +
  ggtitle(&quot;RT raw data plot with 95% confidence intervals&quot;) + stat_summary(fun.y=mean, geom=&quot;line&quot;)</code></pre>
<p><img src="Reaction_Time_files/figure-html/unnamed-chunk-9-1.png" width="672" /></p>
<pre class="r"><code>#fitted model (aka predictive values) plot with 95% confidence intervals
ggplot(KSS_Complete_TIDY, aes(time, reaction_time, colour=SD)) + 
  labs(y=&quot;Reaction Time (ms)&quot;, x=&quot;Time point&quot;) +
  ggtitle(&quot;RT model fitted (predicted) data plot with 95% confidence intervals&quot;) + 
  theme_bw() + stat_summary(aes(y=fitted(RT.final.model)), fun.data=mean_cl_normal, fun.args=list(conf.int=0.95), geom=&quot;pointrange&quot;) + stat_smooth(method = &quot;lm&quot;, formula  =y ~ poly(x,3))</code></pre>
<p><img src="Reaction_Time_files/figure-html/unnamed-chunk-9-2.png" width="672" /></p>
</div>



</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
